<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>README</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h1 id="htaccess-snippets">.htaccess Snippets</h1>
    <p>Uma coleção de snippets .htaccess úteis, tudo em um só lugar.</p>
    <p>
      <strong>Disclaimer</strong>: ao deixar cair o trecho em um arquivo
      <code>.htaccess</code> é a maior parte do tempo suficiente, há casos em
      que algumas modificações podem ser necessárias. Use por sua conta e risco.
    </p>
    <p>
      <strong>IMPORTANTE</strong>: Apache 2.4 introduz algumas alterações
      significativas, principalmente na configuração de controle de acesso. Para
      mais informações, consulte o
      <a href="https://httpd.apache.org/docs/2.4/upgrading.html"
        >upgrading document</a
      >
      bem como
      <a href="https://github.com/phanan/htaccess/issues/2">this issue</a>.
    </p>
    <h2 id="créditos">Créditos</h2>
    <p>
      O que estamos fazendo aqui é principalmente a coleta trechos úteis de todo
      o interwebs (por exemplo, uma boa parte é de
      <a href="https://github.com/h5bp/server-configs-apache"
        >Apache Server Configs</a
      >) em um só lugar. Enquanto estamos tentando dar crédito onde, devido, as
      coisas podem estar em falta. Se você acreditar em qualquer coisa que está
      aqui deve ser dado o seu trabalho e créditos, avise-nos, ou apenas enviar
      uma PR.
    </p>
    <h2 id="tabela-de-conteúdo">Tabela de Conteúdo</h2>
    <ul>
      <li>
        <a href="#rewrite-and-redirection">Rewrite and Redirection</a>
        <ul>
          <li><a href="#force-www">Force www</a></li>
          <li>
            <a href="#force-www-in-a-generic-way">Force www in a Generic Way</a>
          </li>
          <li><a href="#force-non-www">Force non-www</a></li>
          <li>
            <a href="#force-non-www-in-a-generic-way"
              >Force non-www in a Generic Way</a
            >
          </li>
          <li><a href="#force-https">Force HTTPS</a></li>
          <li>
            <a href="#force-https-behind-a-proxy">Force HTTPS Behind a Proxy</a>
          </li>
          <li><a href="#force-trailing-slash">Force Trailing Slash</a></li>
          <li><a href="#remove-trailing-slash">Remove Trailing Slash</a></li>
          <li><a href="#redirect-a-single-page">Redirect a Single Page</a></li>
          <li>
            <a href="#alias-a-single-directory">Alias a Single Directory</a>
          </li>
          <li><a href="#alias-paths-to-script">Alias Paths to Script</a></li>
          <li>
            <a href="#redirect-an-entire-site">Redirect an Entire Site</a>
          </li>
          <li><a href="#alias-clean-urls">Alias “Clean” URLs</a></li>
        </ul>
      </li>
      <li>
        <a href="#security">Security</a>
        <ul>
          <li><a href="#deny-all-access">Deny All Access</a></li>
          <li>
            <a href="#deny-all-access-except-yours"
              >Deny All Access Except Yours</a
            >
          </li>
          <li>
            <a href="#allow-all-access-except-spammers"
              >Allow All Access Except Spammers’</a
            >
          </li>
          <li>
            <a href="#deny-access-to-hidden-files-and-directories"
              >Deny Access to Hidden Files and Directories</a
            >
          </li>
          <li>
            <a href="#deny-access-to-backup-and-source-files"
              >Deny Access to Backup and Source Files</a
            >
          </li>
          <li>
            <a href="#disable-directory-browsing">Disable Directory Browsing</a>
          </li>
          <li>
            <a href="#disable-image-hotlinking">Disable Image Hotlinking</a>
          </li>
          <li>
            <a href="#disable-image-hotlinking-for-specific-domains"
              >Disable Image Hotlinking for Specific Domains</a
            >
          </li>
          <li>
            <a href="#password-protect-a-directory"
              >Password Protect a Directory</a
            >
          </li>
          <li>
            <a href="#password-protect-a-file-or-several-files"
              >Password Protect a File or Several Files</a
            >
          </li>
          <li>
            <a href="#block-visitors-by-referrer">Block Visitors by Referrer</a>
          </li>
          <li>
            <a href="#prevent-framing-the-site">Prevent Framing the Site</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#performance">Performance</a>
        <ul>
          <li><a href="#compress-text-files">Compress Text Files</a></li>
          <li><a href="#set-expires-headers">Set Expires Headers</a></li>
          <li><a href="#turn-etags-off">Turn eTags Off</a></li>
        </ul>
      </li>
      <li>
        <a href="#miscellaneous">Miscellaneous</a>
        <ul>
          <li><a href="#set-php-variables">Set PHP Variables</a></li>
          <li><a href="#custom-error-pages">Custom Error Pages</a></li>
          <li><a href="#force-downloading">Force Downloading</a></li>
          <li><a href="#prevent-downloading">Prevent Downloading</a></li>
          <li>
            <a href="#allow-cross-domain-fonts">Allow Cross-Domain Fonts</a>
          </li>
          <li><a href="#auto-utf-8-encode">Auto UTF-8 Encode</a></li>
          <li>
            <a href="#switch-to-another-php-version"
              >Switch to Another PHP Version</a
            >
          </li>
          <li>
            <a href="#disable-internet-explorer-compatibility-view"
              >Disable Internet Explorer Compatibility View</a
            >
          </li>
          <li><a href="#serve-webp-images">Serve WebP Images</a></li>
        </ul>
      </li>
    </ul>
    <h2 id="rewrite-and-redirection">Rewrite and Redirection</h2>
    <p>
      Nota: Presume-se que você tem <code>mod_rewrite</code> instalado e
      habilitado.
    </p>
    <h3 id="force-www">Force www</h3>
    <pre class="apacheconf"><code>RewriteEngine on
RewriteCond %{HTTP_HOST} ^example\.com [NC]
RewriteRule ^(.*)$ http://www.example.com/$1 [L,R=301,NC]</code></pre>
    <h3 id="force-www-in-a-generic-way">Force www in a Generic Way</h3>
    <pre class="apacheconf"><code>RewriteCond %{HTTP_HOST} !^$
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTPS}s ^on(s)|
RewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]</code></pre>
    <p>
      Isso funciona para <em>any</em> domain.
      <a
        href="https://stackoverflow.com/questions/4916222/htaccess-how-to-force-www-in-a-generic-way"
        >Source</a
      >
    </p>
    <h3 id="force-non-www">Force non-www</h3>
    <p>
      It’s <a href="http://www.sitepoint.com/domain-www-or-no-www/">still</a>
      <a href="https://devcenter.heroku.com/articles/apex-domains">open</a>
      <a href="http://yes-www.org/">for</a>
      <a href="http://no-www.org/">debate</a> se www ou non-www é o caminho a
      percorrer, por isso, se acontecer de você ser um fã de domínios descalços,
      aqui você vai:
    </p>
    <pre class="apacheconf"><code>RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.example\.com [NC]
RewriteRule ^(.*)$ http://example.com/$1 [L,R=301]</code></pre>
    <h3 id="force-non-www-in-a-generic-way">Force non-www in a Generic Way</h3>
    <pre class="apacheconf"><code>RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.
RewriteCond %{HTTPS}s ^on(s)|off
RewriteCond http%1://%{HTTP_HOST} ^(https?://)(www\.)?(.+)$
RewriteRule ^ %1%3%{REQUEST_URI} [R=301,L]</code></pre>
    <h3 id="force-https">Force HTTPS</h3>
    <pre class="apacheconf"><code>RewriteEngine on
RewriteCond %{HTTPS} !on
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

# Nota: Também é recomendável habilitar HTTP Strict Transport Segurança (HSTS)
# Em seu site HTTPS para ajudar a prevenir ataques man-in-the-middle.
# Veja https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security
&lt;IfModule mod_headers.c&gt;
    Header sempre definido Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot;
&lt;/IfModule&gt;</code></pre>
    <h3 id="force-https-behind-a-proxy">Force HTTPS Behind a Proxy</h3>
    <p>
      Útil se você tiver um proxy na frente do seu servidor a realização de
      terminação TLS.
    </p>
    <pre class="apacheconf"><code>RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}</code></pre>
    <h3 id="force-trailing-slash">Force Trailing Slash</h3>
    <pre class="apacheconf"><code>RewriteCond %{REQUEST_URI} /+[^\.]+$
RewriteRule ^(.+[^/])$ %{REQUEST_URI}/ [R=301,L]</code></pre>
    <h3 id="remove-trailing-slash">Remove Trailing Slash</h3>
    <pre class="apacheconf"><code>RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ /$1 [R=301,L]</code></pre>
    <h3 id="redirect-a-single-page">Redirect a Single Page</h3>
    <pre
      class="apacheconf"
    ><code>Redirect 301 /oldpage.html http://www.example.com/newpage.html
Redirect 301 /oldpage2.html http://www.example.com/folder/</code></pre>
    <p>
      <a href="http://css-tricks.com/snippets/htaccess/301-redirects/"
        >Source</a
      >
    </p>
    <h3 id="alias-a-single-directory">Alias a Single Directory</h3>
    <pre class="apacheconf"><code>RewriteEngine On
RewriteRule ^source-directory/(.*) target-directory/$1</code></pre>
    <h3 id="alias-paths-to-script">Alias Paths to Script</h3>
    <pre class="apacheconf"><code>FallbackResource /index.fcgi</code></pre>
    <p>
      Este exemplo tem um arquivo <code>index.fcgi</code> em algum diretório, e
      todos os pedidos dentro desse diretório que não conseguem resolver um
      diretório / nome do arquivo será enviado para o<code
        >script index.fcgi</code
      >. É bom se você quer <code>baz.foo / some / cool / path</code> a ser
      feitos pelo<code>baz.foo / index.fcgi</code> (que também suporta pedidos
      de <code>baz.foo</code>), mantendo<code>baz.foo/css/ style.css</code> e
      semelhantes. Tenha acesso ao caminho original da variável de ambiente
      PATH_INFO, como exposto no seu ambiente de script.
    </p>
    <pre class="apacheconf"><code>RewriteEngine On
RewriteRule ^$ index.fcgi/ [QSA,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.fcgi/$1 [QSA,L]</code></pre>
    <p>
      Esta é uma versão menos eficiente da directiva FallbackResource (porque o
      uso do <code>mod_rewrite</code> é mais complexa do que apenas lidar com
      o<code>directiva FallbackResource</code>), mas também é mais flexível.
    </p>
    <h3 id="redirect-an-entire-site">Redirect an Entire Site</h3>
    <pre
      class="apacheconf"
    ><code>Redirect 301 / http://newsite.com/</code></pre>
    <p>
      Desta forma, faz com links intactos. Ou seja
      <code>www.oldsite.com/some/crazy/link.html</code> se tornará
      <code>www.newsite.com/some/crazy/link.html</code>. Isto é extremamente
      útil quando você é apenas “moving” um site para um novo domínio.
      <a href="http://css-tricks.com/snippets/htaccess/301-redirects/"
        >Source</a
      >
    </p>
    <h3 id="alias-clean-urls">Alias “Clean” URLs</h3>
    <p>
      Este trecho permite que você use “clean” URLs – aqueles sem uma extensão
      do PHP, por exemplo <code>example.com/users</code> em vez de
      <code>example.com/users.php</code>.
    </p>
    <pre class="apacheconf"><code>RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule ^([^.]+)$ $1.php [NC,L]</code></pre>
    <p>
      <a
        href="http://www.abeautifulsite.net/access-pages-without-the-php-extension-using-htaccess/"
        >Source</a
      >
    </p>
    <h2 id="security">Security</h2>
    <h3 id="deny-all-access">Deny All Access</h3>
    <pre class="apacheconf"><code>## Apache 2.2
Deny from all

## Apache 2.4
# Require all denied</code></pre>
    <p>
      Mas espere, isso irá bloqueá-lo a partir do seu conteúdo, bem! Assim, a
      introdução de …
    </p>
    <h3 id="deny-all-access-except-yours">Deny All Access Except Yours</h3>
    <pre class="apacheconf"><code>## Apache 2.2
Order deny,allow
Deny from all
Allow from xxx.xxx.xxx.xxx

## Apache 2.4
# Require all denied
# Require ip xxx.xxx.xxx.xxx</code></pre>
    <p>
      <code>xxx.xxx.xxx.xxx</code> é seu IP. Se você substituir os três últimos
      dígitos com 0/12 por exemplo, isso vai especificar um intervalo de IPs
      dentro da mesma rede, poupando-lhe o trabalho de listar todos os IPs
      autorizados separadamente.
      <a
        href="http://speckyboy.com/2013/01/08/useful-htaccess-snippets-and-hacks/"
        >Source</a
      >
    </p>
    <p>Agora é claro que há uma versão invertida:</p>
    <h3 id="allow-all-access-except-spammers">
      Allow All Access Except Spammers’
    </h3>
    <pre class="apacheconf"><code>## Apache 2.2
Order deny,allow
Deny from xxx.xxx.xxx.xxx
Deny from xxx.xxx.xxx.xxy

## Apache 2.4
# Require all granted
# Require not ip xxx.xxx.xxx.xxx
# Require not ip xxx.xxx.xxx.xxy</code></pre>
    <h3 id="deny-access-to-hidden-files-and-directories">
      Deny Access to Hidden Files and Directories
    </h3>
    <p>
      Arquivos e diretórios ocultos (aqueles cujos nomes começam com um ponto
      <code>.</code>) deve maioria, se não todos, o tempo ser assegurado. por
      exemplo: <code>.htaccess</code>, <code>.htpasswd</code>,
      <code>.git</code>, <code>.hg</code>…
    </p>
    <pre class="apacheconf"><code>RewriteCond %{SCRIPT_FILENAME} -d [OR]
RewriteCond %{SCRIPT_FILENAME} -f
RewriteRule &quot;(^|/)\.&quot; - [F]</code></pre>
    <p>
      Alternativamente, você pode simplesmente levantar uma
      <code>Not Found</code> erro, dando a cara atacante nenhuma pista:
    </p>
    <pre class="apacheconf"><code>RedirectMatch 404 /\..*$</code></pre>
    <h3 id="deny-access-to-backup-and-source-files">
      Deny Access to Backup and Source Files
    </h3>
    <p>
      Esses arquivos podem ser deixados por alguns editores de texto / html
      (como Vi / Vim) e representam um grande perigo de segurança, se exposto a
      público.
    </p>
    <pre
      class="apacheconf"
    ><code>&lt;FilesMatch &quot;(\.(bak|config|dist|fla|inc|ini|log|psd|sh|sql|swp)|~)$&quot;&gt;
    ## Apache 2.2
    Order allow,deny
    Deny from all
    Satisfy All

    ## Apache 2.4
    # Require all denied
&lt;/FilesMatch&gt;</code></pre>
    <p><a href="https://github.com/h5bp/server-configs-apache">Source</a></p>
    <h3 id="disable-directory-browsing">Disable Directory Browsing</h3>
    <pre class="apacheconf"><code>Options All -Indexes</code></pre>
    <h3 id="disable-image-hotlinking">Disable Image Hotlinking</h3>
    <pre class="apacheconf"><code>RewriteEngine on
# Remova a seguinte linha se você deseja bloquear referrer em branco também
RewriteCond %{HTTP_REFERER} !^$

RewriteCond %{HTTP_REFERER} !^https?://(.+\.)?example.com [NC]
RewriteRule \.(jpe?g|png|gif|bmp)$ - [NC,F,L]

# Se você deseja exibir um banner &quot;bloqueada&quot; em lugar da imagem hotlink,
# Substituir a regra acima, com:
# RewriteRule \.(jpe?g|png|gif|bmp) http://example.com/blocked.png [R,L]</code></pre>
    <h3 id="disable-image-hotlinking-for-specific-domains">
      Disable Image Hotlinking for Specific Domains
    </h3>
    <p>
      Às vezes você quer desabilitar imagem hotlinking de alguns bandidos só.
    </p>
    <pre class="apacheconf"><code>RewriteEngine on
RewriteCond %{HTTP_REFERER} ^https?://(.+\.)?badsite\.com [NC,OR]
RewriteCond %{HTTP_REFERER} ^https?://(.+\.)?badsite2\.com [NC,OR]
RewriteRule \.(jpe?g|png|gif|bmp)$ - [NC,F,L]

# Se você deseja exibir um banner &quot;bloqueada&quot; em lugar da imagem hotlink,
# Substituir a regra acima, com:
# RewriteRule \.(jpe?g|png|gif|bmp) http://example.com/blocked.png [R,L]</code></pre>
    <h3 id="password-protect-a-directory">Password Protect a Directory</h3>
    <p>
      Primeiro você precisa criar um arquivo <code>.htpasswd</code> em algum
      lugar do sistema:
    </p>
    <div class="sourceCode" id="cb24">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="ex">htpasswd</span> -c /home/fellowship/.htpasswd boromir</a></code></pre>
    </div>
    <p>Em seguida, você pode usá-lo para autenticação:</p>
    <pre class="apacheconf"><code>AuthType Basic
AuthName &quot;One does not simply&quot;
AuthUserFile /home/fellowship/.htpasswd
Require valid-user</code></pre>
    <h3 id="password-protect-a-file-or-several-files">
      Password Protect a File or Several Files
    </h3>
    <pre class="apacheconf"><code>AuthName &quot;One still does not simply&quot;
AuthType Basic
AuthUserFile /home/fellowship/.htpasswd

&lt;Files &quot;one-ring.o&quot;&gt;
Require valid-user
&lt;/Files&gt;

&lt;FilesMatch ^((one|two|three)-rings?\.o)$&gt;
Require valid-user
&lt;/FilesMatch&gt;</code></pre>
    <h3 id="block-visitors-by-referrer">Block Visitors by Referrer</h3>
    <p>
      Este nega o acesso para todos os usuários que estão vindo de (indicado
      por) um domínio específico.
      <a href="http://www.htaccess-guide.com/deny-visitors-by-referrer/"
        >Source</a
      >
    </p>
    <pre class="apacheconf"><code>RewriteEngine on
# Options +FollowSymlinks
RewriteCond %{HTTP_REFERER} somedomain\.com [NC,OR]
RewriteCond %{HTTP_REFERER} anotherdomain\.com
RewriteRule .* - [F]</code></pre>
    <h3 id="prevent-framing-the-site">Prevent Framing the Site</h3>
    <p>
      Isso impede que o site para ser enquadrado (ou seja, colocar em uma
      <code>iframe</code> tag), quando ainda permite o enquadramento para uma
      URI específica.
    </p>
    <pre
      class="apacheconf"
    ><code>SetEnvIf Request_URI &quot;/starry-night&quot; allow_framing=true
Header set X-Frame-Options SAMEORIGIN env=!allow_framing</code></pre>
    <h2 id="performance">Performance</h2>
    <h3 id="compress-text-files">Compress Text Files</h3>
    <pre class="apacheconf"><code>&lt;IfModule mod_deflate.c&gt;

    # Force compression for mangled headers.
    # https://developer.yahoo.com/blogs/ydn/pushing-beyond-gzipping-25601.html
    &lt;IfModule mod_setenvif.c&gt;
        &lt;IfModule mod_headers.c&gt;
            SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
            RequestHeader append Accept-Encoding &quot;gzip,deflate&quot; env=HAVE_Accept-Encoding
        &lt;/IfModule&gt;
    &lt;/IfModule&gt;

    # Comprimir toda a saída marcada com um dos seguintes procedimentos MIME-types
    # (para versões do Apache 2.3.7 abaixo, você não precisa habilitar `mod_filter`
    #  pode remover as linhas `&lt;IfModule mod_filter.c&gt;` e `&lt;/IfModule&gt;` 
    #  como `AddOutputFilterByType` ainda está em diretivas principais).
    &lt;IfModule mod_filter.c&gt;
        AddOutputFilterByType DEFLATE application/atom+xml \
                                      application/javascript \
                                      application/json \
                                      application/rss+xml \
                                      application/vnd.ms-fontobject \
                                      application/x-font-ttf \
                                      application/x-web-app-manifest+json \
                                      application/xhtml+xml \
                                      application/xml \
                                      font/opentype \
                                      image/svg+xml \
                                      image/x-icon \
                                      text/css \
                                      text/html \
                                      text/plain \
                                      text/x-component \
                                      text/xml
    &lt;/IfModule&gt;

&lt;/IfModule&gt;</code></pre>
    <p><a href="https://github.com/h5bp/server-configs-apache">Source</a></p>
    <h3 id="set-expires-headers">Set Expires Headers</h3>
    <p>
      <em>Expira headers</em> dizer ao navegador se eles devem solicitar um
      arquivo específico do servidor ou apenas agarrá-lo a partir do cache. É
      aconselhável definir um conteúdo estática que expira no futuro. Se você
      não controlar o versionamento com cache baseado em filename, tem que
      considerar uma redução do tempo de cache para recursos como CSS e JS para
      algo como uma semana.
      <a href="https://github.com/h5bp/server-configs-apache">Source</a>
    </p>
    <pre class="apacheconf"><code>&lt;IfModule mod_expires.c&gt;
    ExpiresActive on
    ExpiresDefault                                      &quot;access plus 1 month&quot;

  # CSS
    ExpiresByType text/css                              &quot;access plus 1 year&quot;

  # Data interchange
    ExpiresByType application/json                      &quot;access plus 0 seconds&quot;
    ExpiresByType application/xml                       &quot;access plus 0 seconds&quot;
    ExpiresByType text/xml                              &quot;access plus 0 seconds&quot;

  # Favicon (cannot be renamed!)
    ExpiresByType image/x-icon                          &quot;access plus 1 week&quot;

  # HTML components (HTCs)
    ExpiresByType text/x-component                      &quot;access plus 1 month&quot;

  # HTML
    ExpiresByType text/html                             &quot;access plus 0 seconds&quot;

  # JavaScript
    ExpiresByType application/javascript                &quot;access plus 1 year&quot;

  # Manifest files
    ExpiresByType application/x-web-app-manifest+json   &quot;access plus 0 seconds&quot;
    ExpiresByType text/cache-manifest                   &quot;access plus 0 seconds&quot;

  # Media
    ExpiresByType audio/ogg                             &quot;access plus 1 month&quot;
    ExpiresByType image/gif                             &quot;access plus 1 month&quot;
    ExpiresByType image/jpeg                            &quot;access plus 1 month&quot;
    ExpiresByType image/png                             &quot;access plus 1 month&quot;
    ExpiresByType video/mp4                             &quot;access plus 1 month&quot;
    ExpiresByType video/ogg                             &quot;access plus 1 month&quot;
    ExpiresByType video/webm                            &quot;access plus 1 month&quot;

  # Web feeds
    ExpiresByType application/atom+xml                  &quot;access plus 1 hour&quot;
    ExpiresByType application/rss+xml                   &quot;access plus 1 hour&quot;

  # Web fonts
    ExpiresByType application/font-woff2                &quot;access plus 1 month&quot;
    ExpiresByType application/font-woff                 &quot;access plus 1 month&quot;
    ExpiresByType application/vnd.ms-fontobject         &quot;access plus 1 month&quot;
    ExpiresByType application/x-font-ttf                &quot;access plus 1 month&quot;
    ExpiresByType font/opentype                         &quot;access plus 1 month&quot;
    ExpiresByType image/svg+xml                         &quot;access plus 1 month&quot;
&lt;/IfModule&gt;</code></pre>
    <h3 id="turn-etags-off">Turn eTags Off</h3>
    <p>
      Ao remover o cabeçalho <code>ETag</code>, você desativar caches e
      navegadores de ser capaz de validar os arquivos, então eles são forçados a
      confiar em seu<code>Cache-Control</code> e <code>cabeçalho Expires</code>.
      <a href="http://www.askapache.com/htaccess/apache-speed-etags.html"
        >Source</a
      >
    </p>
    <pre class="apacheconf"><code>&lt;IfModule mod_headers.c&gt;
    Header unset ETag
&lt;/IfModule&gt;
FileETag None</code></pre>
    <h2 id="miscellaneous">Miscellaneous</h2>
    <h3 id="set-php-variables">Set PHP Variables</h3>
    <pre class="apacheconf"><code>php_value &lt;key&gt; &lt;val&gt;

# Por exemplo:
php_value upload_max_filesize 50M
php_value max_execution_time 240</code></pre>
    <h3 id="custom-error-pages">Custom Error Pages</h3>
    <pre
      class="apacheconf"
    ><code>ErrorDocument 500 &quot;Houston, você tem um problema.&quot;
ErrorDocument 401 http://error.example.com/mordor.html
ErrorDocument 404 /errors/halflife3.html</code></pre>
    <h3 id="force-downloading">Force Downloading</h3>
    <p>
      Às vezes você quer forçar o navegador para baixar algum conteúdo em vez de
      exibi-lo.
    </p>
    <pre class="apacheconf"><code>&lt;Files *.md&gt;
    ForceType application/octet-stream
    Header set Content-Disposition attachment
&lt;/Files&gt;</code></pre>
    <p>Agora a um yang a este yin:</p>
    <h3 id="prevent-downloading">Prevent Downloading</h3>
    <p>
      Às vezes você quer forçar o navegador para exibir algum conteúdo em vez de
      baixá-lo.
    </p>
    <pre
      class="apacheconf"
    ><code>&lt;FilesMatch &quot;\.(tex|log|aux)$&quot;&gt;
    Header set Content-Type text/plain
&lt;/FilesMatch&gt;</code></pre>
    <h3 id="allow-cross-domain-fonts">Allow Cross-Domain Fonts</h3>
    <p>
      CDN-served webfonts pode não funcionar no Firefox ou IE devido à
      <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing"
        >CORS</a
      >. Este trecho resolve o problema.
    </p>
    <pre class="apacheconf"><code>&lt;IfModule mod_headers.c&gt;
    &lt;FilesMatch &quot;\.(eot|otf|ttc|ttf|woff|woff2)$&quot;&gt;
        Header set Access-Control-Allow-Origin &quot;*&quot;
    &lt;/FilesMatch&gt;
&lt;/IfModule&gt;</code></pre>
    <p>
      <a href="https://github.com/h5bp/server-configs-apache/issues/32"
        >Source</a
      >
    </p>
    <h3 id="auto-utf-8-encode">Auto UTF-8 Encode</h3>
    <p>Seu texto deve ser sempre codificação UTF-8, não?</p>
    <pre
      class="apacheconf"
    ><code># Use codificação UTF-8 para qualquer coisa como text/plain ou text/html
AddDefaultCharset utf-8

# Força UTF-8 para um número de formatos de arquivo
AddCharset utf-8 .atom .css .js .json .rss .vtt .xml</code></pre>
    <p><a href="https://github.com/h5bp/server-configs-apache">Source</a></p>
    <h3 id="switch-to-another-php-version">Switch to Another PHP Version</h3>
    <p>
      Se você estiver em um servidor compartilhado, as chances são de que há
      mais de uma versão do PHP instalado, e às vezes você quer uma versão
      específica para o seu site. por exemplo,
      <a href="https://github.com/laravel/laravel">Laravel</a> requer PHP &gt;=
      5.4. O seguinte trecho deve mudar a versão do PHP para você.
    </p>
    <pre class="apacheconf"><code>AddHandler application/x-httpd-php55 .php

# Alternativamente, você pode usar AddType
AddType application/x-httpd-php55 .php</code></pre>
    <h3 id="disable-internet-explorer-compatibility-view">
      Disable Internet Explorer Compatibility View
    </h3>
    <p>
      Exibição de Compatibilidade no IE pode afetar a forma como alguns sites
      são exibidos. O seguinte trecho deve forçar o IE para usar o Edge
      Rendering Engine e desativar o Compatibility View.
    </p>
    <pre class="apacheconf"><code>&lt;IfModule mod_headers.c&gt;
    BrowserMatch MSIE is-msie
    Header set X-UA-Compatible IE=edge env=is-msie
&lt;/IfModule&gt;</code></pre>
    <h3 id="serve-webp-images">Serve WebP Images</h3>
    <p>
      Se
      <a href="https://developers.google.com/speed/webp/?csw=1">WebP images</a>
      são suportados em uma imagem com uma extensão .webp e ela encontra-se no
      mesmo lugar como o jpg/png imagem que vai ser servida, em seguida, a
      imagem WebP é servido em vez do jpg/png.
    </p>
    <pre class="apacheconf"><code>RewriteEngine On
RewriteCond %{HTTP_ACCEPT} image/webp
RewriteCond %{DOCUMENT_ROOT}/$1.webp -f
RewriteRule (.+)\.(jpe?g|png)$ $1.webp [T=image/webp,E=accept:1]</code></pre>
    <p>
      <a href="https://github.com/vincentorback/WebP-images-with-htaccess"
        >Source</a
      >
    </p>
  </body>
</html>
